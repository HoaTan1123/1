local Player = game:GetService("Players").LocalPlayer
local RunService = game:GetService("RunService")

local function AdvancedNoclip(character)
    for _, part in pairs(character:GetDescendants()) do
        if part:IsA("BasePart") then
            part.CanCollide = false
            part.CanTouch = false
            part.CanQuery = false
        end
    end
    
    local noclipConnection
    noclipConnection = RunService.Stepped:Connect(function()
        local root = character:FindFirstChild("HumanoidRootPart")
        if not root then return end
        
        for _, part in pairs(workspace:GetPartsInRadius(root.Position, 5)) do
            if part:IsA("BasePart") and part.CanCollide then
                part.CanCollide = false
                part.CanTouch = false
                part.CanQuery = false
                
                if not part:FindFirstChild("NoclipModified") then
                    local tag = Instance.new("BoolValue")
                    tag.Name = "NoclipModified"
                    tag.Parent = part
                end
            end
        end
    end)
    
    character.DescendantAdded:Connect(function(part)
        if part:IsA("BasePart") then
            part.CanCollide = false
            part.CanTouch = false
            part.CanQuery = false
        end
    end)
    
    return noclipConnection
end

local function Main()
    local character = Player.Character or Player.CharacterAdded:Wait()
    local connection = AdvancedNoclip(character)
    
    Player.CharacterAdded:Connect(function(newChar)
        if connection then
            connection:Disconnect()
        end
        connection = AdvancedNoclip(newChar)
    end)
end

game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "✅ 穿墙已激活 [v0.15.5]",
    Text = "高级穿墙模式已启用\n自动处理5米内所有障碍物",
    Duration = 5,
    Button1 = "确定",
    Icon = "rbxassetid://6724403529"
})

task.delay(1, Main)
